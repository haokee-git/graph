# 修改计划：优化锯齿与弹簧伸缩逻辑

根据您的需求，我们将进行两方面的优化：一是通过渲染层面解决视觉上的“锯齿”问题，二是通过物理层面的逻辑修改，实现“弹簧绳”的自动伸缩效果，最终趋向于直线。

## 1. 解决锯齿问题 (渲染层优化)

锯齿主要是因为我们直接用 `lineTo` 连接了所有粒子，而粒子数量较多且受力微小波动导致。
*   **修改 `src/engine/Renderer.ts`**：
    *   在绘制边时，不再简单地遍历连接所有粒子。
    *   改用 **二次贝塞尔曲线 (Quadratic Bézier Curve)** 或 **Catmull-Rom 样条** 来平滑连接粒子点。
    *   具体做法：取相邻两点的中点作为控制点进行绘制，使线条圆滑。

## 2. 改变引擎逻辑：弹簧绳自动伸缩 (物理层优化)

目前的逻辑是 `segmentLength` 固定为初始长度，导致绳子永远保持初始的总长度。我们需要让它动态趋向于“标准长度”（即更短的长度，最终变为直线）。

*   **修改 `src/engine/PhysicsEngine.ts`**：
    *   引入 `IDEAL_SEGMENT_LENGTH` 常量（例如 5 或 10），作为所有绳段最终想达到的理想长度。
    *   在 `update` 循环中，**动态调整 `edge.segmentLength`**：
        *   如果 `currentSegmentLength > IDEAL_SEGMENT_LENGTH`，则每帧减少一点（收缩）。
        *   如果 `currentSegmentLength < IDEAL_SEGMENT_LENGTH`，则每帧增加一点（伸长）。
        *   这样，无论初始多乱，绳子都会逐渐收缩变紧，最终两点间的绳子会趋向于直线（因为总长度变短了）。
    *   为了防止收缩过快导致物理爆炸，设置一个渐变系数（如 0.01）。

## 3. 计划步骤

1.  **渲染优化**：修改 `Renderer.ts`，实现平滑曲线绘制。
2.  **物理优化**：修改 `PhysicsEngine.ts`，实现 `segmentLength` 的动态趋向逻辑。
3.  **验证与重启**：构建并重启服务器。
